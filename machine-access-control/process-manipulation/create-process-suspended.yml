rule:
  meta:
    name: create process suspended
    author: william.ballenthin@fireeye.com
    rule-category: machine-access-control/process-manipulation/create-process-suspended
    scope: basic block
    examples:
      - Practical Malware Analysis Lab 03-03.exe_:0x4010EA
  features:
    - and:
      - or:
        - number: 0x08000004 = CREATE_NO_WINDOW | CREATE_SUSPENDED
        - number: 4 = CREATE_SUSPENDED
      - or:
        - api: kernel32.CreateProcess
        - api: advapi32.CreateProcessAsUser
