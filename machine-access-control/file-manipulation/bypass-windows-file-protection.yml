rule:
  meta:
    name: bypass windows file protection via undocumented SFC API
    rule-category: machine-access-control/file-manipulation/bypass-windows-file-protection
    author: michael.hunhoff@fireeye.com
    scope: function
    examples:
      - Practical Malware Analysis Lab 01-04.exe_:0x401174
  features:
    - and:
      - string: sfc_os.dll              #   System File Checker
      - number: 0x2                     #   SfcTerminateWatcherThread
      - match: link function at runtime
