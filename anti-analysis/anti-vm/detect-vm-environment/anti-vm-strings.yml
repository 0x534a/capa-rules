rule:
  meta:
    name: anti-vm strings
    rule-category: anti-analysis/anti-vm/detect-vm-environment
    author: moritz.raabe@fireeye.com
    reference: https://github.com/ctxis/CAPE/blob/master/modules/signatures/antivm_*
    scope: file
    examples:
      - Practical Malware Analysis Lab 17-02.dll_
  features:
    - or:
      - string: /VMWare/i
      - string: /VMTools/i
      - string: /vmGuestLib.dll/i
      - string: /VBox/i
      - string: /VirtualBox/i
      - string: /drivers\\vboxdrv/i
      - string: /HARDWARE\\ACPI\\(DSDT|FADT|RSDT)\\BOCHS/i
      - string: /HARDWARE\\DESCRIPTION\\System\\(SystemBiosVersion|VideoBiosVersion)/i
      - string: /HARDWARE\\DESCRIPTION\\System\\CentralProcessor\\.*ProcessorNameString/i
      - string: /HARDWARE\\DEVICEMAP\\Scsi\\Scsi Port 0\\Scsi Bus 0\\Target Id 0\\Logical Unit Id 0/i
      - string: /SYSTEM\\(CurrentControlSet|ControlSet001)\\Enum\\IDE/i
      - string: /SYSTEM\\(CurrentControlSet|ControlSet001)\\Services\\Disk\\Enum\\/i
      - string: /SYSTEM\\(CurrentControlSet|ControlSet001)\\Control\\SystemInformation\\SystemManufacturer/i
