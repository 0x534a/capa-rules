rule:
  meta:
    name: query registry key
    namespace: host-interaction/registry/query
    author: michael.hunhoff@fireeye.com
    scope: basic block
    att&ck:
      - Discovery::Query Registry [T1012]
    mbc:
      - Operating System::Registry::Query Registry Key [C0036.005]
    examples:
      - 493167E85E45363D09495D0841C30648:0x404930
      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x402608
  features:
    - or:
      - api: advapi32.RegEnumKey
      - api: advapi32.RegEnumKeyEx
      - api: advapi32.RegQueryInfoKeyA
      - api: ZwQueryKey
      - api: ZwEnumerateKey
      - api: NtQueryKey
      - api: NtEnumerateKey
      - api: RtlCheckRegistryKey
      - api: SHEnumKeyEx
      - api: SHQueryInfoKey
      - api: SHRegEnumUSKey
      - api: SHRegQueryInfoUSKey
