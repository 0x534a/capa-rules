rule:
  meta:
    name: open registry key
    namespace: host-interaction/registry/open
    author: michael.hunhoff@fireeye.com
    scope: basic block
    mbc:
      - Operating System::Registry::Open Registry Key [C0036.003]
    examples:
      - Practical Malware Analysis Lab 03-02.dll_:0x10004706
      - 493167E85E45363D09495D0841C30648:0x404D60
      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4045F2
  features:
    - or:
      - api: advapi32.RegOpenKey
      - api: advapi32.RegOpenKeyEx
      - api: advapi32.RegCreateKey
      - api: advapi32.RegCreateKeyEx
      - api: advapi32.RegOpenCurrentUser
      - api: advapi32.RegOpenKeyTransacted
      - api: advapi32.RegOpenUserClassesRoot
      - api: advapi32.RegCreateKeyTransacted
      - api: ZwOpenKey
      - api: ZwOpenKeyEx
      - api: ZwCreateKey
      - api: ZwOpenKeyTransacted
      - api: ZwOpenKeyTransactedEx
      - api: ZwCreateKeyTransacted
      - api: NtOpenKey
      - api: SHRegOpenUSKey
      - api: SHRegCreateUSKey
