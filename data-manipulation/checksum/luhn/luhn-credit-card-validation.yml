rule:
  meta:
    name: luhn credit card validation
    namespace: data-manipulation/checksum
    author: "@_re_fox"
    scope: function
    examples:
      - 1d8fd13c890060464019c0f07b928b1a:0x401920
      - 60abaef3fda131ffa20df480cb3f8029:0x4048e0
  features:
    - and:
      - basic block:
        - and:
          - number: 0x0
          - number: 0x2
          - number: 0x4
          - number: 0x6
          - number: 0x8
          - number: 0x1
          - number: 0x3
          - number: 0x5
          - number: 0x7
          - number: 0x9
        description: Digital root lookup table
      - basic block:
        - and:
          - number: 0x30
          - mnemonic: sub
          description: Conversion of chr to int 
      - basic block:
        - and:
          - mnemonic: idiv
          - mnemonic: cdq
          - number: 0xa
          - optional : 
            - mnemonic: neg
          description: Final section returning checkum % 10
