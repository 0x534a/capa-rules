rule:
  meta:
    name: hash data using SHA1 via WinCrypt
    namespace: data-manipulation/hashing/sha1
    author: michael.hunhoff@fireeye.com
    scope: function
    att&ck:
      - n/a
    mbc:
      - n/a
  features:
    - or:
      - and:
        - match: initialize wincrypt hash
        - number: 0x8004 = CALG_SHA1
        - api: advapi32.CryptHashData
