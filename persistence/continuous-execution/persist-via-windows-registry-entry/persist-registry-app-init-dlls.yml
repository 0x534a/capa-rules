rule:
  meta:
    name: persists via AppInit_DLLs
    rule-category: persistence/continuous-execution/persist-via-windows-registry-entry
    author: michael.hunhoff@fireye.com
    scope: function
    examples:
      - Practical Malware Analysis Lab 11-02.dll_:0x1000158b
  features:
    - and:
      - or:
        - or:
          - match: set registry value
        - or:
          - number: 0x80000002 = HKEY_LOCAL_MACHINE
      - string: /SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Windows/i
      - string: AppInit_DLLs