rule:
  meta:
    name: persists via Run key
    rule-category: persistence/continuous-execution/persist-via-windows-registry-entry
    author: moritz.raabe@fireeye.com
    scope: function
    examples:
      - Practical Malware Analysis Lab 06-03.exe_:0x401130
  features:
    - and:
      - or:
        - or:
          - api: advapi32.RegOpenKey
          - api: advapi32.RegOpenKeyEx
        - or:
          - api: advapi32.RegSetValue
          - api: advapi32.RegSetValueEx
        - or:
          - number: 0x80000001 = HKEY_CURRENT_USER
          - number: 0x80000002 = HKEY_LOCAL_MACHINE
      - string: /Software\\Microsoft\\Windows\\CurrentVersion\\Run/i
