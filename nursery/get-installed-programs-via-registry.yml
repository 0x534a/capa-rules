rule:
  meta:
    name: get installed programs via registry
    rule-category: machine-access-control/inspect-installed-programs/get-installed-programs
    author: moritz.raabe@fireeye.com
    scope: function
  features:
    - and:
      - match: open registry key
      - string: /SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall/i
      - characteristic(loop): true