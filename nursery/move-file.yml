rule:
  meta:
    name: move file
    rule-category: machine-access-control/file-manipulation/move-file
    author: moritz.raabe@fireeye.com
    scope: function
  features:
    - or:
      - api: kernel32.MoveFile
      - api: kernel32.MoveFileEx
      - api: MoveFileWithProgress
      - api: MoveFileTransacted
      - api: rename
      - api: _wrename
      - basic block:
        - and:
          - number: 1 = FO_MOVE
          - or:
            - api: kernel32.SHFileOperation
