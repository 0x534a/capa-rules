rule:
  meta:
    name: SHA1 hash via wincrypt
    rule-category: data-manipulation/hash-data/hash-data-using-sha1
    author: michael.hunhoff@fireeye.com
    scope: function
  features:
    - or:
      - and:
        - match: initialize wincrypt hash
        - number: 0x8004 = CALG_SHA1
        - api: advapi32.CryptHashData
