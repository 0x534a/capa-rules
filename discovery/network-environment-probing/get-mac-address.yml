rule:
  meta:
    name: get MAC address
    rule-category: discovery/network-environment-probing/get-mac-address
    author: moritz.raabe@fireeye.com
    scope: function
    examples:
      - 65CFE3A06D981CE36F6BCDAA7E633B3F:0x48FCA0
  features:
    - and:
      - api: iphlpapi.GetAdaptersInfo
      - or:
        - offset: 0x194 = IP_ADAPTER_INFO.Address
        - offset: 0x195 = IP_ADAPTER_INFO.Address+1
        - offset: 0x196 = IP_ADAPTER_INFO.Address+2
        - offset: 0x197 = IP_ADAPTER_INFO.Address+3
        - offset: 0x198 = IP_ADAPTER_INFO.Address+4
        - offset: 0x199 = IP_ADAPTER_INFO.Address+5
      - optional:
        - string: '%02X-%02X-%02X-%02X-%02X-%02X'
