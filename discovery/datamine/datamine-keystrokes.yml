rule:
  meta:
    name: datamine keystrokes
    rule-category: discovery/datamine/datamine-keystrokes
    author: moritz.raabe@fireeye.com
    scope: function
    examples:
      - C91887D861D9BD4A5872249B641BC9F9:0x4015FD
  features:
    - or:
      - and:
        - api: SetWindowsHookEx
        - api: GetKeyState
      - and:
        - api: RegisterHotKey
        - api: user32.keybd_event
        - api: UnregisterHotKey
      - and:
        - api: CallNextHookEx
        - api: user32.GetKeyNameText
        - api: user32.GetAsyncKeyState
        - api: user32.GetForgroundWindow
      - api: user32.AttachThreadInput
      - api: user32.MapVirtualKey
